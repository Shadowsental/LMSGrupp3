@model IEnumerable<LMSGrupp3.Models.Entities.Course>

@{
    ViewData["Title"] = "Courses";
}

<h1>Courses</h1>

<p>
    <a class="btn btn-sm btn-primary" asp-action="Create">
        <i class="fas fa-plus"></i> Create New Course
    </a>
</p>

@{ if (TempData["newUser"] != null)
    {
        //TempData["newUser"] = "Skapade ny " + Input.Role;  //  "Skapade användaren '" + Input.Name + "' (" + Input.Role + ")";
        //TempData["newUserData"] = Input.Name + " (" + Input.Email + ")";

        <div class="alert alert-success">
            <strong>@TempData["newUser"]</strong><br />
            @TempData["newUserData"]
        </div>
    }
}
<br />
@if (Model.ToArray().Length > 0)
{
    <table class="table table-hover table-condensed">
        <thead>
            <tr>
                <th title="Course Name">
                    @Html.DisplayNameFor(model => model.Name)
                </th>
                <th title="Description">
                    @Html.DisplayNameFor(model => model.Description)
                </th>
                <th title="Start Date">
                    @Html.DisplayNameFor(model => model.StartDate)
                </th>
                <th title="Number of Modules">
                    Antal&nbsp;@Html.DisplayNameFor(model => model.Modules)
                </th>
                <th title="Number of Students Assigned">
                    Antal&nbsp;@Html.DisplayNameFor(model => model.Users)
                </th>
                <th>

                </th>
            </tr>

        </thead>

        <tbody>
            @foreach (var item in Model)
            {
                string moduleTitle = "";
                foreach (var m in item.Modules)
                {
                    moduleTitle = moduleTitle + "\n" + m.Name;
                }
                @if (moduleTitle == "")
                {
                    moduleTitle = "No Modules in " + item.Name + "!";
                }
                else
                {
                    moduleTitle = "Modules in " + item.Name + ": " + moduleTitle;
                }


                string userTitle = "";
                foreach (var u in item.Users)
                {
                    userTitle = userTitle + "\n" + u.User.Name;
                }
                @if (userTitle == "")
                {
                    userTitle = "No Users at " + item.Name + "!";
                }
                else
                {
                    userTitle = "Users at " + item.Name + ": " + userTitle;
                }



                <tr onclick="window.location.href='Courses/Details/@item.Id'">
                    <td title="Click to show details and add Modules">
                        @Html.DisplayFor(modelItem => item.Name)
                    </td>
                    <td title="Click to show details and add Modules">
                        @Html.DisplayFor(modelItem => item.Description)
                    </td>
                    <td title="Click to show details and add Modules">
                        @Html.DisplayFor(modelItem => item.StartDate)
                    </td>
                    <td align="center" title="@moduleTitle">
                        @Html.DisplayFor(modelItem => item.Modules.Count)
                    </td>
                    <td align="center" title="@userTitle">
                        @Html.DisplayFor(modelItem => item.Users.Count)
                    </td>
                    <td></td>
                </tr>
            }
        </tbody>
    </table>
}
else
{
    <hr />
    <h5><i>No Courses currently added</i></h5>
}
